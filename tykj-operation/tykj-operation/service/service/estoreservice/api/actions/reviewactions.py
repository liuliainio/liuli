# -*- coding: utf-8 -*-
import time
import re

from baseaction import BaseAction
from django.http import HttpResponse
from estorecore.db import timestamp_utc_now
from estorecore.utils import friendly_size
from estoreservice.api.utils import get_parameter_GET, get_parameter_POST, get_parameter_META, get_parameter_POST_or_GET
from estoreservice.utils.utils import app_post_process, to_int_array


class PostReviewAction(BaseAction):
    BLOCK_WORDS = [u'taip',
                   u'吴方城',
                   u'静坐',
                   u'台独',
                   u'小参考',
                   u'干你娘',
                   u'马时敏',
                   u'人民内情真相',
                   u'飞扬论坛',
                   u'阴蒂',
                   u'华建敏',
                   u'北京当局',
                   u'高官',
                   u'统战',
                   u'睾丸',
                   u'反封锁技术',
                   u'江ze民',
                   u'猪毛1',
                   u'劳改',
                   u'李少民',
                   u'大史',
                   u'回民',
                   u'学联',
                   u'简鸿章',
                   u'黄祸',
                   u'柴玲',
                   u'刘晓波',
                   u'刘宾雁',
                   u'出卖',
                   u'bignews',
                   u'朱毛',
                   u'天安门一代',
                   u'被盗',
                   u'他妈',
                   u'林樵清',
                   u'舆论',
                   u'国家机密',
                   u'李总理',
                   u'4.25',
                   u'六四',
                   u'弟子',
                   u'古怪歌',
                   u'傅申奇',
                   u'喷你',
                   u'青天白日旗',
                   u'梁光烈',
                   u'迪里夏提',
                   u'信用危机',
                   u'邓笑贫',
                   u'nmis',
                   u'干死你',
                   u'法*功',
                   u'王涵万',
                   u'盛华仁',
                   u'薛伟',
                   u'东方红时空',
                   u'猪毛',
                   u'江猪媳',
                   u'护法',
                   u'万润南',
                   u'操你',
                   u'学自联',
                   u'李文斌',
                   u'刘国凯',
                   u'高瞻',
                   u'大花逼',
                   u'淫穴',
                   u'朱镕基',
                   u'吴仁华',
                   u'博讯',
                   u'毛厕洞',
                   u'哈批',
                   u'阴水',
                   u'异议人士',
                   u'情妇',
                   u'黎安友',
                   u'李录',
                   u'花花公子',
                   u'工力',
                   u'网特',
                   u'incest',
                   u'时代论坛',
                   u'梁擎墩',
                   u'中国孤儿院',
                   u'事实独立',
                   u'自焚',
                   u'方励之',
                   u'反攻',
                   u'人民报',
                   u'项小吉',
                   u'洗脑',
                   u'美国之音',
                   u'水扁',
                   u'黑庄',
                   u'大奖',
                   u'林长盛',
                   u'朱容基',
                   u'playboy',
                   u'奸淫',
                   u'法lun功',
                   u'魏新生',
                   u'东突厥斯坦',
                   u'鸽派',
                   u'钟山风雨论坛',
                   u'阝月',
                   u'李洪志',
                   u'江流氓',
                   u'俄国',
                   u'民运',
                   u'王辅臣',
                   u'毛泽东',
                   u'李总统',
                   u'4-Jun',
                   u'新华内情',
                   u'chinaliberal',
                   u'程铁军',
                   u'刘宾深',
                   u'大史记',
                   u'看中国',
                   u'刘刚',
                   u'操他',
                   u'李志绥',
                   u'靠你妈',
                   u'台湾政论区',
                   u'中华讲清',
                   u'僵贼',
                   u'江贼',
                   u'肖强',
                   u'7.22',
                   u'林慎立',
                   u'李宏志',
                   u'刘千石',
                   u'去你妈的',
                   u'屄',
                   u'毛贼东',
                   u'林保华',
                   u'鲍彤',
                   u'龟公',
                   u'下体',
                   u'发抡',
                   u'新疆独',
                   u'boxun',
                   u'宋祖英',
                   u'印尼伊斯兰祈祷团',
                   u'岳武',
                   u'中俄边界新约',
                   u'新观察论坛',
                   u'yuming',
                   u'支那',
                   u'神通加持法',
                   u'异见人士',
                   u'伊斯兰运动',
                   u'锦涛',
                   u'两会新闻',
                   u'宏志',
                   u'东北独立',
                   u'保钓',
                   u'鸡毛信文汇',
                   u'罢课',
                   u'黄翔',
                   u'插你',
                   u'三陪',
                   u'江罗',
                   u'triangle',
                   u'屠杀',
                   u'张志清',
                   u'jiangdongriji',
                   u'五不',
                   u'世界经济导报',
                   u'主席',
                   u'南大自由论坛',
                   u'镇压',
                   u'集会',
                   u'泄密',
                   u'王希哲',
                   u'春夏自由论坛',
                   u'嫖娼',
                   u'精液',
                   u'传单',
                   u'郭伯雄',
                   u'戴相龙',
                   u'招妓',
                   u'猛料',
                   u'贾廷安',
                   u'东社',
                   u'法抡',
                   u'huanet',
                   u'刘晓竹',
                   u'丁元',
                   u'李淑娴',
                   u'张健',
                   u'廉政大论坛',
                   u'陈小同',
                   u'抗日',
                   u'wangce',
                   u'九-评',
                   u'nacb',
                   u'刘永川',
                   u'四川独立',
                   u'宇明网',
                   u'发论公',
                   u'程真',
                   u'马大维',
                   u'开放',
                   u'牛逼',
                   u'大法',
                   u'天安门',
                   u'天葬',
                   u'大逼',
                   u'你说我说论坛',
                   u'张伟国',
                   u'项怀诚',
                   u'吴邦国',
                   u'老毛',
                   u'法功',
                   u'人民真实',
                   u'杨周',
                   u'6.4',
                   u'王超华',
                   u'外交与方略',
                   u'赤匪',
                   u'幼齿',
                   u'木犀地',
                   u'廖锡龙',
                   u'华夏文摘',
                   u'蔡崇国',
                   u'老江',
                   u'狗娘',
                   u'新语丝',
                   u'真善忍',
                   u'中华时事',
                   u'chinamz',
                   u'民国',
                   u'藏独',
                   u'时事参考',
                   u'自由民主论坛',
                   u'风雨神州',
                   u'红灯区',
                   u'东突',
                   u'阴茎',
                   u'童屹',
                   u'操比',
                   u'王瑞林',
                   u'郭岩华',
                   u'民主',
                   u'龙卷风',
                   u'远志明',
                   u'奶子',
                   u'台湾狗',
                   u'人权',
                   u'高文谦',
                   u'骚货',
                   u'狗操',
                   u'歌功颂德',
                   u'操你妈',
                   u'freechina',
                   u'unixbox',
                   u'宋平',
                   u'基督',
                   u'陈军',
                   u'积克馆',
                   u'高自联',
                   u'我日',
                   u'东南西北论谈',
                   u'弹劾',
                   u'反革命',
                   u'中华人民正邪',
                   u'zhengjianwang',
                   u'zhenshanren',
                   u'程凯',
                   u'周锋锁',
                   u'劳动教养所',
                   u'贱逼',
                   u'婊子',
                   u'邵家健',
                   u'洪吟',
                   u'falun',
                   u'国贼',
                   u'反日',
                   u'地下教会',
                   u'迟浩田',
                   u'木子论坛',
                   u'亦凡',
                   u'蒙古独立',
                   u'经文',
                   u'falu',
                   u'收容所',
                   u'温元凯',
                   u'台盟',
                   u'斐得勒',
                   u'关卓中',
                   u'作秀',
                   u'反腐败论坛',
                   u'风雨神州论坛',
                   u'王力雄',
                   u'自由运动',
                   u'学运',
                   u'svdc',
                   u'贼民',
                   u'大纪元',
                   u'主义',
                   u'胡紧掏',
                   u'鸡八',
                   u'中华大地',
                   u'钱其琛',
                   u'分裂',
                   u'阎明复',
                   u'你妈的',
                   u'发轮',
                   u'反共',
                   u'发伦',
                   u'抢粮记',
                   u'发仑',
                   u'发沦',
                   u'失密',
                   u'司马晋',
                   u'善恶有报',
                   u'大参考',
                   u'发纶',
                   u'发论',
                   u'中国猪',
                   u'小泉',
                   u'邝锦文',
                   u'法囵',
                   u'精子',
                   u'方舟子',
                   u'国家安全',
                   u'华岳时事论坛',
                   u'万晓东',
                   u'李兰菊',
                   u'疆独',
                   u'择民',
                   u'making',
                   u'两个中国',
                   u'李鹏',
                   u'数据中国',
                   u'迫害',
                   u'唐柏桥',
                   u'陈破空',
                   u'flg',
                   u'朱溶剂',
                   u'太子党',
                   u'朱琳',
                   u'中国问题论坛',
                   u'江折民',
                   u'税力',
                   u'renmingbao',
                   u'滕文生',
                   u'色情',
                   u'大家论坛',
                   u'ustibet',
                   u'中国之春',
                   u'刘华清',
                   u'江澤民',
                   u'21世纪中国基金会',
                   u'民主墙',
                   u'熊炎',
                   u'新华举报',
                   u'则民',
                   u'将则民',
                   u'朱嘉明',
                   u'于浩成',
                   u'酱猪媳',
                   u'马良骏',
                   u'八老',
                   u'bitch',
                   u'共产党',
                   u'王沪宁',
                   u'开放杂志',
                   u'逼样',
                   u'洪志',
                   u'乳房',
                   u'贯通两极法',
                   u'大b',
                   u'郭平',
                   u'淫秽',
                   u'杂种',
                   u'群奸',
                   u'烂逼',
                   u'你娘',
                   u'北韩',
                   u'法轮功',
                   u'贾育台',
                   u'万维读者论坛',
                   u'韩联潮',
                   u'gcd',
                   u'真象',
                   u'大B',
                   u'safeweb',
                   u'泽民',
                   u'杜智富',
                   u'联总',
                   u'抡功',
                   u'中国和平',
                   u'黄慈萍',
                   u'文革',
                   u'讲法',
                   u'民猪',
                   u'日货',
                   u'日他',
                   u'性欲',
                   u'陈炳基',
                   u'吴学灿',
                   u'新闻封锁',
                   u'shit',
                   u'法谪功',
                   u'中国威胁论',
                   u'中华民国',
                   u'刘凯中',
                   u'时事论坛',
                   u'倪育贤',
                   u'做爱',
                   u'卖比',
                   u'宋xx',
                   u'轮功',
                   u'peacehall',
                   u'阴唇',
                   u'曹长青',
                   u'狂操',
                   u'揭批书',
                   u'E周刊',
                   u'发正念',
                   u'巴赫',
                   u'持不同政见',
                   u'杨建利',
                   u'氵去',
                   u'李继耐',
                   u'中国论坛',
                   u'妈批',
                   u'triangleboy',
                   u'陈蒙',
                   u'何德普',
                   u'法轮',
                   u'张万年',
                   u'悔过书',
                   u'独立',
                   u'作爱',
                   u'何勇',
                   u'张伯笠',
                   u'由喜贵',
                   u'黄菊　',
                   u'拉丹',
                   u'伦功',
                   u'统独论坛',
                   u'中华养生益智功',
                   u'李洪宽',
                   u'一中一台',
                   u'GCD',
                   u'陈一谘',
                   u'rfa',
                   u'creaders',
                   u'法抡功',
                   u'江绵恒',
                   u'王军涛',
                   u'谢长廷',
                   u'我操',
                   u'你妈',
                   u'姜春云',
                   u'xinsheng',
                   u'示威',
                   u'王若望',
                   u'共产',
                   u'张昭富',
                   u'刘士贤',
                   u'狗屎',
                   u'江戏子',
                   u'胡锦涛',
                   u'密穴',
                   u'拉登',
                   u'B样',
                   u'李大师',
                   u'国军',
                   u'教养院',
                   u'89-64cdjp',
                   u'共党',
                   u'大中华论坛',
                   u'冯素英',
                   u'于大海',
                   u'杨月清',
                   u'正义党论坛',
                   u'天怒',
                   u'16大',
                   u'台湾自由联盟',
                   u'闹事',
                   u'falundafa',
                   u'台湾建国运动组织',
                   u'你爸',
                   u'禁看',
                   u'达赖',
                   u'瞒报',
                   u'雪山狮子',
                   u'dafa',
                   u'李瑞环',
                   u'严家祺',
                   u'政治犯',
                   u'余英时',
                   u'龙虎豹',
                   u'钓鱼岛',
                   u'外交论坛',
                   u'江core',
                   u'黄菊',
                   u'颜射',
                   u'王秀丽',
                   u'乔石',
                   u'新生网',
                   u'张钢',
                   u'石戈',
                   u'妓女',
                   u'吴百益',
                   u'李长春',
                   u'教徒',
                   u'新疆独立',
                   u'涉日',
                   u'江猪',
                   u'戈扬',
                   u'尉健行',
                   u'费良勇',
                   u'转化',
                   u'十八摸',
                   u'两会',
                   u'zhengjian',
                   u'sex',
                   u'freenet',
                   u'人民大众时事参考',
                   u'赵海青',
                   u'fa',
                   u'徐才厚',
                   u'徐匡迪',
                   u'氵去车仑工力',
                   u'接班',
                   u'斯诺',
                   u'傻B',
                   u'赤化',
                   u'轻舟快讯',
                   u'炼功',
                   u'卖国',
                   u'voachinese',
                   u'西藏',
                   u'江青',
                   u'freedom',
                   u'唐捷',
                   u'熊焱',
                   u'两岸关系',
                   u'北大三角地论坛',
                   u'包皮',
                   u'钱达',
                   u'车仑',
                   u'易志熹',
                   u'李登辉',
                   u'回民暴',
                   u'罗干',
                   u'吴学璨',
                   u'台湾青年独立联盟',
                   u'操蛋',
                   u'丁子霖',
                   u'刘青',
                   u'双十节',
                   u'司徒华',
                   u'升天',
                   u'民族矛盾',
                   u'二逼',
                   u'发愣',
                   u'独夫',
                   u'江八点',
                   u'上海帮',
                   u'陈希同',
                   u'王刚',
                   u'狗b',
                   u'常劲',
                   u'明慧',
                   u'苏绍智',
                   u'王策',
                   u'沈彤',
                   u'大史纪',
                   u'非典',
                   u'狗B',
                   u'罢工',
                   u'dfdz',
                   u'自民党',
                   u'学潮',
                   u'香港总部',
                   u'小鸡鸡',
                   u'王丹',
                   u'抗议',
                   u'游行',
                   u'反封锁',
                   u'naive',
                   u'性交',
                   u'流亡',
                   u'正法',
                   u'中国社会进步党',
                   u'民意论坛',
                   u'推翻',
                   u'热比娅',
                   u'联总之声传单',
                   u'李旺阳',
                   u'封杀',
                   u'猪操',
                   u'高薪养廉',
                   u'法愣',
                   u'共匪',
                   u'全国两会',
                   u'tibetalk',
                   u'严家其',
                   u'hongzhi',
                   u'联总之声',
                   u'谢选骏',
                   u'吴官正',
                   u'个人崇拜',
                   u'台湾独立',
                   u'宋书元',
                   u'吕秀莲',
                   u'吴弘达',
                   u'fuck',
                   u'魏京生',
                   u'暴乱',
                   u'民阵',
                   u'反人类',
                   u'争鸣论坛',
                   u'李红痔',
                   u'大众真人真事',
                   u'曾培炎',
                   u'东西南北论坛',
                   u'连胜德',
                   u'fa轮',
                   u'cnd',
                   u'台*湾',
                   u'民意',
                   u'胡景涛',
                   u'汪岷',
                   u'苏晓康',
                   u'庆红',
                   u'走私',
                   u'政权',
                   u'日内瓦金融',
                   u'法论',
                   u'蒙独',
                   u'法伦',
                   u'破鞋',
                   u'邢铮',
                   u'许家屯',
                   u'中华人民实话实说',
                   u'赵紫阳',
                   u'上海孤儿院',
                   u'华语世界论坛',
                   u'李小朋',
                   u'华通时事论坛',
                   u'政治风波',
                   u'voa',
                   u'齐墨',
                   u'汉奸',
                   u'玄`机',
                   u'老人政治',
                   u'盛雪',
                   u'多维',
                   u'江主席',
                   u'北美自由论坛',
                   u'尹庆民',
                   u'牛比',
                   u'郑源',
                   u'正见网',
                   u'中国真实内容',
                   u'大比',
                   u'法十轮十功',
                   u'八九',
                   u'暴政',
                   u'6-4tianwang',
                   u'统独',
                   u'chinesenewsnet',
                   u'徐水良',
                   u'发骚',
                   u'日你',
                   u'两岸三地论坛',
                   u'西藏独立',
                   u'潘国平',
                   u'晚年周恩来',
                   u'北京之春',
                   u'王炳章',
                   u'工自联',
                   u'胡锦滔',
                   u'热站政论网',
                   u'九评',
                   u'毛片',
                   u'周天法',
                   u'建国党',
                   u'UltraSurf',
                   u'赵品潞',
                   u'肛门',
                   u'吴宏达',
                   u'轮大',
                   u'温家宝',
                   u'Soccer01.com',
                   u'蒙古独',
                   u'屁眼',
                   u'天安门录影带',
                   u'政治反对派',
                   u'hypermart.net',
                   u'minghui',
                   u'1989',
                   u'凌锋',
                   u'操逼',
                   u'金尧如',
                   u'肛交',
                   u'阴道',
                   u'郭罗基',
                   u'马三家',
                   u'易丹轩',
                   u'淫荡',
                   u'江泽慧',
                   u'台湾独',
                   u'张林',
                   u'李老师',
                   u'天安门事件',
                   u'邓小平',
                   u'河殇',
                   u'上访',
                   u'瑞士金融大学',
                   u'龟头',
                   u'政变',
                   u'西藏独',
                   u'反社会',
                   u'罗礼诗',
                   u'杨怀安',
                   u'九.评',
                   u'贱比',
                   u'郑义',
                   u'日死你',
                   u'simple',
                   u'陈总统',
                   u'美国参考',
                   u'民进党',
                   u'江独裁',
                   u'傅志寰',
                   u'东方时空',
                   u'付申奇',
                   u'地下刊物',
                   u'靖国神社',
                   u'义解',
                   u'夜话紫禁城',
                   u'中华真实报道',
                   u'红色恐怖',
                   u'功法',
                   u'亲美',
                   u'姚月谦',
                   u'13423205670',
                   u'包赢',
                   u'钦本立',
                   u'大纪园',
                   u'莫伟强',
                   u'法仑',
                   u'法沦',
                   u'法纶',
                   u'鸡巴',
                   u'法.轮.功',
                   u'指点江山论坛',
                   u'李禄',
                   u'电视流氓',
                   u'打炮',
                   u'共狗',
                   u'国研新闻邮件',
                   u'伍凡',
                   u'秦晋',
                   u'九、评',
                   u'邪恶',
                   u'自已的故事',
                   u'造反',
                   u'杨巍',
                   u'谢中之',
                   u'冯东海',
                   u'独裁政治',
                   u'发囵',
                   u'赵南',
                   u'蛤蟆',
                   u'贱货',
                   u'二B',
                   u'曾庆红',
                   u'压迫',
                   u'中共',
                   u'zhuanfalun',
                   u'中功',
                   u'祁建',
                   u'洪传',
                   u'日本',
                   u'哲民',
                   u'猪聋畸',
                   u'刘文胜',
                   u'贾庆林',
                   u'司马璐',
                   u'洪哲胜',
                   u'登辉',
                   u'人民真实报道',
                   u'粉饰太平',
                   u'修炼',
                   u'无界浏览器',
                   u'屙民',
                   u'强奸',
                   u'人民之声论坛',
                   u'傻逼',
                   u'dpp',
                   u'王宝森',
                   u'人民大众',
                   u'胡总书记',
                   u'dajiyuan',
                   u'动乱',
                   u'人民报讯',
                   u'王润生',
                   u'宏法',
                   u'赵晓微',
                   u'六合彩',
                   u'曹刚川',
                   u'我操你',
                   u'烂比',
                   u'中国复兴论坛',
                   u'他妈的',
                   u'江则民',
                   u'minghuinews',
                   u'两会报道',
                   u'天安门屠杀',
                   u'钱国梁',
                   u'僵贼民',
                   u'姬胜德',
                   u'狗卵子',
                   u'白皮书',
                   u'吾尔开希',
                   u'大中国论坛',
                   u'十六大',
                   u'陈宣良',
                   u'韩东方',
                   u'wstaiji',
                   u'鲍戈',
                   u'轮奸',
                   u'法谪',
                   u'发抡功',
                   u'独立台湾会',
                   u'中华大众',
                   u'江泽民',
                   u'贱人',
                   u'民联',
                   u'大纪元新闻网',
                   u'劳教',
                   u'徐邦秦',
                   u'renminbao',
                   u'无能',
                   u'李月月鸟',
                   u'辛灏年',
                   u'卖逼',
                   u'东土耳其斯坦',
                   u'刘俊国',
                   u'分家在',
                   u'泡沫经济',
                   u'新华通论坛',
                   u'江贼民',
                   u'烂货',
                   u'专制',
                   u'功友',
                   u'中国社会论坛',
                   u'央视内部晚会',
                   u'绵恒',
                   u'突厥斯坦',
                   u'hrichina',
                   u'李小鹏',
                   u'封从德',
                   u'独裁',
                   u'胡平',
                   u'汤光中',
                   u'丁关根',
                   u'亲日',
                   u'幼女',
                   u'发论功',
                   u'发伦功',
                   u'周旋',
                   u'王冶坪',
                   u'共军',
                   u'中俄边界',
                   u'傻逼洪志',
                   u'第四代',
                   u'李岚清',
                   u'黄色',
                   u'回民暴动',
                   u'佛展千手法',
                   u'舆论反制',
                   u'陆委会',
                   u'张宏堡',
                   u'射精',
                   u'刘山青',
                   u'白梦',
                   u'paper64',
                   u'他母亲',
                   u'lihongzhi',
                   u'中奖',
                   u'四川独',
                   u'白立朴',
                   u'胡锦淘',
                   u'吕京花',
                   u'成人小说',
                   u'成人文学',
                   u'成人电影',
                   u'成人影视',
                   u'黄色电影',
                   u'黄色影视',
                   u'黄色小说',
                   u'黄色文学',
                   u'成人图片',
                   u'黄色图片',
                   u'黄色漫画',
                   u'成人漫画',
                   u'三级片',
                   u'成人论坛',
                   u'六合采',
                   u'激情电影',
                   u'虐杀',
                   u'乱伦',
                   u'迷药',
                   u'迷幻药',
                   u'三唑',
                   u'迷奸',
                   u'换妻',
                   u'淫水',
                   u'应招',
                   u'留园网',
                   u'腐败',
                   u'文化大革命',
                   u'中国国家防火墙',
                   u'林海',
                   u'黄琦',
                   u'蒋世华',
                   u'綦彦臣',
                   u'刘荻',
                   u'吴一然',
                   u'李毅斌',
                   u'欧阳懿',
                   u'陶海东',
                   u'蔡陆军',
                   u'罗永忠',
                   u'杜导斌',
                   u'罗长福',
                   u'颜均',
                   u'李志',
                   u'王小宁',
                   u'马亚莲',
                   u'赵岩',
                   u'郑贻春',
                   u'师涛',
                   u'李建平',
                   u'许万平',
                   u'任自元',
                   u'李元龙',
                   u'郭起真',
                   u'昝爱宗',
                   u'陈秋兰',
                   u'白秀华',
                   u'专政',
                   u'群体灭绝',
                   u'oppression',
                   u'封锁',
                   u'汕尾东洲',
                   u'邓力群',
                   u'迷魂药',
                   u'推油',
                   u'代开发票',
                   u'胡耀邦',
                   u'华国锋',
                   u'周恩来',
                   u'刘少奇',
                   u'林彪',
                   u'宋庆龄',
                   u'孙中山',
                   u'彭德怀',
                   u'朱德',
                   u'董必武',
                   u'万里',
                   u'李先念',
                   u'陈独秀',
                   u'瞿秋白',
                   u'向忠发',
                   u'杨尚昆',
                   u'蒋介石',
                   u'台湾团结联盟',
                   u'泛绿',
                   u'国民党',
                   u'泛蓝',
                   u'宋美龄',
                   u'蒋经国',
                   u'蒋方良',
                   u'马英九',
                   u'西藏流亡政府',
                   u'达赖喇嘛',
                   u'根敦·确吉尼玛',
                   u'根敦·确吉、确吉尼玛',
                   u'www.tibetalk.com',
                   u'PX',
                   u'《新京报》',
                   u'激流中国',
                   u'双轨',
                   u'毛泽东复活',
                   u'假币',
                   u'地下先烈们',
                   u'活人器官',
                   u'性爱',
                   u'身份证号码生成器',
                   u'一码中特',
                   u'成人区',
                   u'地下的先烈们',
                   u'颠覆国家政权',
                   u'窃听器',
                   u'tianwang',
                   u'cdjp',
                   u'hypermart',
                   u'paper',
                   u'xxx',
                   u'anime',
                   u'censor',
                   u'hentai',
                   u'[hz]',
                   u'(hz)',
                   u'[av]',
                   u'(av)',
                   u'[sm]',
                   u'(sm)',
                   u'porn',
                   u'码',
                   u'淫',
                   u'操',
                   u'乳',
                   u'阴',
                   u'奸',
                   u'性',
                   u'裸',
                   u'骚',
                   u'顶级',
                   u'女优',
                   u'小泽玛莉亚',
                   u'强歼',
                   u'乱交',
                   u'色友',
                   u'蒲团',
                   u'美女',
                   u'女女',
                   u'喷尿',
                   u'绝版',
                   u'三级',
                   u'武腾兰',
                   u'穴',
                   u'凌辱',
                   u'暴干',
                   u'诱惑',
                   u'小泽圆',
                   u'插插',
                   u'坐交',
                   u'长濑爱',
                   u'川岛和津实',
                   u'草莓牛奶',
                   u'小泽园',
                   u'饭岛爱',
                   u'星崎未来',
                   u'及川奈央',
                   u'朝河兰',
                   u'夕树舞子',
                   u'大泽惠',
                   u'金泽文子',
                   u'三浦爱佳',
                   u'伊东',
                   u'慰安妇',
                   u'女教师',
                   u'武藤兰',
                   u'学生妹',
                   u'无毛',
                   u'猛插',
                   u'护士',
                   u'自拍',
                   u'嫂',
                   u'A片',
                   u'A级',
                   u'喷精',
                   u'偷窥',
                   u'小穴',
                   u'被虐',
                   u'被迫',
                   u'被逼',
                   u'强暴',
                   u'口技',
                   u'破处',
                   u'幼交',
                   u'狂干',
                   u'兽交',
                   u'群交',
                   u'叶子楣',
                   u'舒淇',
                   u'翁虹',
                   u'大陆',
                   u'露点',
                   u'露毛',
                   u'波霸',
                   u'少儿不宜',
                   u'成人',
                   u'偷情',
                   u'叫床',
                   u'上床',
                   u'制服',
                   u'亚热',
                   u'援交',
                   u'走光',
                   u'情色',
                   u'肉欲',
                   u'美腿',
                   u'自摸',
                   u'18禁',
                   u'捆绑',
                   u'丝袜',
                   u'潮吹',
                   u'群射',
                   u'内射',
                   u'少妇',
                   u'臭作',
                   u'薄格',
                   u'调教',
                   u'近亲',
                   u'连发',
                   u'限制',
                   u'偷拍',
                   u'更衣',
                   u'无修正',
                   u'一本道',
                   u'1Pondo',
                   u'樱井',
                   u'风花',
                   u'夜勤病栋',
                   u'菱恝',
                   u'虐待',
                   u'激情',
                   u'麻衣',
                   u'吐血',
                   u'三个代表',
                   u'一党',
                   u'多党',
                   u'行房',
                   u'自慰',
                   u'吹萧',
                   u'色狼',
                   u'胸罩',
                   u'内裤',
                   u'底裤',
                   u'私处',
                   u'爽死',
                   u'变态',
                   u'妹疼',
                   u'妹痛',
                   u'弟疼',
                   u'弟痛',
                   u'姐疼',
                   u'姐痛',
                   u'哥疼',
                   u'哥痛',
                   u'同房',
                   u'造爱',
                   u'阳具',
                   u'开苞',
                   u'肉棍',
                   u'肉棒',
                   u'肉洞',
                   u'荡妇',
                   u'阴囊',
                   u'捅你',
                   u'捅我',
                   u'插我',
                   u'插她',
                   u'插他',
                   u'干你',
                   u'干她',
                   u'干他',
                   u'口交',
                   u'阴户',
                   u'阴门',
                   u'阴毛',
                   u'避孕套',
                   u'你妈逼',
                   u'大鸡巴',
                   u'高潮',
                   u'政治',
                   u'红志',
                   u'洪智',
                   u'红智',
                   u'轮公',
                   u'轮攻',
                   u'沦功',
                   u'沦公',
                   u'沦攻',
                   u'论攻',
                   u'论功',
                   u'论公',
                   u'伦攻',
                   u'伦公',
                   u'警察',
                   u'民警',
                   u'公安',
                   u'嫖',
                   u'大盖帽',
                   u'革命',
                   u'武警',
                   u'黑社会',
                   u'交警',
                   u'消防队',
                   u'刑警',
                   u'夜总会',
                   u'妈个',
                   u'公款',
                   u'首长',
                   u'书记',
                   u'坐台',
                   u'城管',
                   u'暴动',
                   u'李远哲',
                   u'司法警官',
                   u'高干',
                   u'人大',
                   u'黄丽满',
                   u'于幼军',
                   u'文字狱',
                   u'骗局',
                   u'猫肉',
                   u'吸储',
                   u'张五常',
                   u'张丕林',
                   u'空难',
                   u'朱鎔基',
                   u'於幼军',
                   u'公安局',
                   u'公安部',
                   u'司法部',
                   u'公检法',
                   u'检察院',
                   u'司法部门',
                   u'执法犯法',
                   u'流氓警察',
                   u'强盗警察',
                   u'土匪政府',
                   u'信产局',
                   u'信息产业部',
                   u'国家信息',
                   u'电信',
                   u'天翼']
    BLOCK_REGEX = re.compile(
        u'.*(' + u'|'.join([re.escape(word) for word in BLOCK_WORDS]) + u').*',
        re.IGNORECASE)

    ERROR_CODE_OK = 0
    ERROR_CODE_AWAITING_MODERATION = 1
    ERROR_CODE_INVALID_DATA = 2

    REVIEW_STATUS_AWAITING_MODERATION = 0
    REVIEW_STATUS_OK = 1
    REVIEW_STATUS_REJECTED = 2

    def __init__(self, app_db, logger):
        super(PostReviewAction, self).__init__()
        self.app_db = app_db
        self.logger = logger

    def contains_block_words(self, text):
        return PostReviewAction.BLOCK_REGEX.match(text) is not None

    def execute(self, request):
        chn = get_parameter_POST_or_GET(
            request,
            'chn',
            required=False,
            str_max_length=255)
        client_id = get_parameter_POST_or_GET(request, 'clientid')
        source = get_parameter_POST_or_GET(
            request,
            'source',
            str_max_length=255)
        app_id = get_parameter_POST_or_GET(
            request,
            'app_id',
            convert_func=int)
        app_version_code = get_parameter_POST_or_GET(
            request,
            'app_version_code',
            convert_func=int)
        app_version_name = get_parameter_POST_or_GET(
            request,
            'app_version_name')
        user_name = get_parameter_POST_or_GET(request, 'user_name')
        review_rate = get_parameter_POST_or_GET(
            request,
            'rate',
            convert_func=int)
        review_content = get_parameter_POST_or_GET(
            request,
            'content',
            str_max_length=1000)
        ip = get_parameter_META(
            request,
            'REMOTE_ADDR',
            required=False,
            default=u'')
        for q in (client_id, source, app_id, app_version_code, app_version_name, user_name, review_rate, review_content):
            if isinstance(q, HttpResponse):
                return q

        error_code = PostReviewAction.ERROR_CODE_OK
        status = PostReviewAction.REVIEW_STATUS_OK
        if self.contains_block_words(app_version_name + user_name + review_content):
            status = PostReviewAction.REVIEW_STATUS_AWAITING_MODERATION
            error_code = PostReviewAction.ERROR_CODE_AWAITING_MODERATION

        review = {
            'app_id': app_id,
            'app_version_code': app_version_code,
            'app_version_name': app_version_name,
            'user_name': user_name,
            'rate': review_rate,
            'content': review_content,
            'source': source,
            'client_id': client_id,
            'ip': ip,
            'created_time': timestamp_utc_now(),
            'status': status,
        }

        self.app_db.save_reviews(review)

        del review['app_id']
        del review['app_version_code']
        del review['source']
        del review['client_id']
        del review['ip']
        del review['status']
        del review['_id']

        return {'error_code': error_code, 'reviews': [review]}


class QueryReviewAction(BaseAction):

    def __init__(self, app_db, logger):
        super(QueryReviewAction, self).__init__()
        self.app_db = app_db
        self.logger = logger

    def query_reviews(self, app_id, start_index=0, count=10):
        return (
            self.app_db.query_reviews(
                app_id,
                review_status=PostReviewAction.REVIEW_STATUS_OK,
                start_index=start_index,
                count=count)
        )

    def execute(self, request):
        chn = get_parameter_GET(
            request,
            'chn',
            required=False,
            str_max_length=255)
        client_id = get_parameter_GET(request, 'clientid')
        source = get_parameter_GET(request, 'source', str_max_length=255)
        app_id = get_parameter_GET(request, 'app_id', convert_func=int)
        app_version_code = get_parameter_GET(
            request,
            'app_version_code',
            convert_func=int)
        start_index = get_parameter_GET(
            request,
            'start_index',
            convert_func=int)
        count = get_parameter_GET(request, 'count', convert_func=int)
        ip = get_parameter_META(
            request,
            'REMOTE_ADDR',
            required=False,
            default=u'')
        for q in (client_id, source, app_id, app_version_code):
            if isinstance(q, HttpResponse):
                return q

        return (
            {'reviews': self.query_reviews(
                app_id,
                start_index=start_index,
                count=count)}
        )


if __name__ == '__main__':
    action = PostReviewAction(None, None)
    print action.contains_block_words('test')
    print action.contains_block_words(u'东西acdsf东西南北论坛sdfsdf')
    print action.contains_block_words(u'a[av]asfasdf')
    print timestamp_utc_now()
    for i in xrange(0, 500):
        action.contains_block_words(
            u'东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a东西a')
    print timestamp_utc_now()
